<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="author" content="Phillip Kim" />
    
    <link rel="shortcut icon" type="image/x-icon" href="/img/favicon.ico">
    <title>Success from NCAA to NFL</title>
    <meta name="generator" content="Hugo 0.107.0">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="/css/main.css" />
    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,400,200bold,400old" />
    
    <!--[if lt IE 9]>
			<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
			<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
		<![endif]-->

    
  </head>

  <body>
    <div id="wrap">
      
      <nav class="navbar navbar-default">
  <div class="container">
    <div class="navbar-header">
      <a class="navbar-brand" href="/"><i class="fa fa-home"></i></a>
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>
    <div class="navbar-collapse collapse" id="navbar">
      <ul class="nav navbar-nav navbar-right">
      
        
        <li><a href="/post/">BLOG</a></li>
        
        <li><a href="/projects/">PROJECTS</a></li>
        
        <li><a href="/resume/">RESUME</a></li>
        
      
      </ul>
    </div>
  </div>
</nav>

      <div class="container">
        <div class="blog-post">
          <h3>
            <strong><a href="/project/project1/">Success from NCAA to NFL</a></strong>
          </h3>
        </div>
 
<div class="blog-title">
          <h4>
         October 18, 2022 
            &nbsp;&nbsp;
            
          </h4>
        </div>

        <div class="panel panel-default">
          <div class="panel-body">
            <div class="blogpost">
              


<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>College football excites hundreds of thousands of people across America year by year, and many collegiate players dream of playing professionally in the NFL. Only a small percentage (1.6%) of college-level players fulfill that dream and get drafted into the NFL. Within this extremely selective process, certain universities and their respective conferences produce more NFL-bound athletes than others. However, does draft success equate to professional success? We are looking to investigate which NCAA conference produces the most successful players in the NFL.</p>
<p>Our final dataset will be composed of 258 individual datasets. Our first dataset (<a href="https://www.pro-football-reference.com/schools/" class="uri">https://www.pro-football-reference.com/schools/</a>) lists 847 different colleges/universities in America based on how many of their players have gone on to play in the NFL. The dataset also lists the number of current active professional players, number of Hall of Famers, number of Pro Bowl selections, total NFL games played amongst alumni, total touchdowns scored by alumni, and the alumnus with the highest career Approximate Value. Each unique row represents an individual school, and the dataset contains both numeric and categorical variables. Our second dataset (<a href="https://collegefootballdata.com/exporter/teams/fbs" class="uri">https://collegefootballdata.com/exporter/teams/fbs</a>) lists every school that has an intercollegiate football program, and also lists each school’s conference. In this dataset, a unique row also represents an individual school, and only categorical variables are present. Our third dataset (<a href="https://www.pro-football-reference.com/leaders/career_av_career.htm" class="uri">https://www.pro-football-reference.com/leaders/career_av_career.htm</a>) lists the top 255 NFL players of all time based on their weighted Approximate Value, which is a measure of the player’s impact on the team based on performance and longevity. The dataset also lists the years of a player’s career, as well as the number of different teams a player played for. In this dataset, a row represents an individual NFL player, and both numeric and categorical variables are present.</p>
<p>The remaining 255 datasets (links to each player in <a href="https://www.pro-football-reference.com/leaders/career_av_career.htm" class="uri">https://www.pro-football-reference.com/leaders/career_av_career.htm</a>) list yearly statistics for each player’s career. The datasets list various statistics like age, team, position, number, games played, and Approximate Value, along with various position-specific statistics. Each unique row represents a year of a player’s career, and the datasets contain both numeric and categorical variables.</p>
<p>Based on these datasets, we may expect to see a positive correlation between a conference’s average weighted Approximate Value and the number of professional players it has produced.</p>
</div>
<div id="tidying" class="section level2">
<h2>Tidying</h2>
<p>All of the datasets are tidy, so tidying functions will be used later for wrangling data.</p>
</div>
<div id="wranglingjoining" class="section level2">
<h2><strong>Wrangling/Joining</strong></h2>
<p>For the wAV_leaders dataset, there were originally 255 observations (players) and 5 unique IDs (Rank, Player, wAV, Years, Tm). Since all 5 of the IDs were unique to the wAV_leaders dataset when compared to the other datasets, the School ID variable was added beforehand to provide a common variable for joining. Since the datasets were joined by the School variable, each school was designated as an individual observation, and variables that applied to individual players were removed. The number of players from each school was generated as a new variable, and the total wAV value for each school was calculated by adding together individual player wAV values after grouping by school.</p>
<p>By observing the first few rows of the new wAV_schools dataset, we can see that two schools have produced the most number of successful players: Miami (FL) and USC.</p>
<pre class="r"><code># Create new object in environment
wAV_schools &lt;- wAV_leaders %&gt;%
  select(-Rank, -Tm,-Years) %&gt;% # Remove specific column variables
  relocate(School) %&gt;% # Move school variable to the front of the dataset
  group_by(School) %&gt;% # Create subsets by school
  mutate(`Top Players` = n()) %&gt;% # Create new variable counting number of observations of each school
  select(-Player) %&gt;% # Remove player column variable
  mutate(`Total wAV` = sum(wAV)) %&gt;% # Create new variable calculating the total wAV value of each school
  select (-wAV) %&gt;% # Remove wAV column variable
  distinct() %&gt;% # Remove duplicate rows
  arrange(desc(`Total wAV`)) # Arrange by variable in descending order
head(wAV_schools) # Quick look at beginning of dataset</code></pre>
<pre><code>## # A tibble: 6 × 3
## # Groups:   School [6]
##   School     `Top Players` `Total wAV`
##   &lt;chr&gt;              &lt;int&gt;       &lt;dbl&gt;
## 1 Miami (FL)            14        1524
## 2 USC                   11        1230
## 3 Pittsburgh             8         876
## 4 Alabama                7         684
## 5 Ohio St.               6         614
## 6 Nebraska               6         604</code></pre>
<p>To prepare the joining of the first three datasets (college, conference, wAV), the conference dataset’s names for each school must match the names in the college dataset.</p>
<pre class="r"><code># Save object in environment
ncaa_schools_adj &lt;- ncaa_schools %&gt;%
  mutate(School = ifelse(School == &quot;Miami&quot;,str_replace(School, &quot;Miami&quot;, &quot;Miami (FL)&quot;),School), # Replace specific string with a different string
         School = ifelse(School == &quot;Grambling&quot;,str_replace(School, &quot;Grambling&quot;,&quot;Grambling State&quot;),School),
         School = ifelse(School == &quot;NC State&quot;,str_replace(School, &quot;NC State&quot;,&quot;North Carolina State&quot;),School),
         School = ifelse(School == &quot;Ole Miss&quot;,str_replace(School, &quot;Ole Miss&quot;,&quot;Mississippi&quot;),School),
         School = ifelse(School == &quot;Mississippi Valley State&quot;,str_replace(School, &quot;Mississippi Valley State&quot;,&quot;Miss. Valley State&quot;),School),
         School = ifelse(School == &quot;Southern Mississippi&quot;,str_replace(School, &quot;Southern Mississippi&quot;,&quot;Southern Miss&quot;),School),
         School = ifelse(School == &quot;UTEP&quot;,str_replace(School, &quot;UTEP&quot;,&quot;Texas-El Paso&quot;),School),
         School = ifelse(School == &quot;Prairie View&quot;,str_replace(School, &quot;Prairie View&quot;,&quot;Prairie View A&amp;M&quot;),School),
         School = ifelse(School == &quot;Maryland-Eastern Shore&quot;,str_replace(School, &quot;Maryland-Eastern Shore&quot;,&quot;Md-Eastern Shore&quot;),School))</code></pre>
<p>Before joining the datasets together, the some column variables in the college dataset were removed. Since the focus is on colleges/conferences producing successful NFL players, statistics that pertain to individual players do not provide any helpful information. Additionally, the names of certain schools were adjusted to match with the names in the conference dataset.</p>
<p>Before joining, the college dataset had 847 observations with 5 unique IDs (Players, Hall of Famers, Pro Bowl Selections, Games Played, Touchdowns), the wAV dataset had 107 observations with 2 unique IDs (Top Players, Total wAV), and the conference dataset had 842 observations with 1 unique ID (Conference). Each dataset had the School ID in common.</p>
<p>After joining the wAV dataset to the college dataset and filtering out any schools that did not produce any of the top 255 players, there were 107 observations left, matching the wAV dataset’s original number of observations. After joining the conference dataset to the new college dataset, the number of observations remained constant because the joining simply added the Conference ID to the college dataset.</p>
<pre class="r"><code># Create new object in environment
college_totals &lt;- college_stats %&gt;%
  select(-Rk,-State,-`Active Players`,-`Highest Career Approximate Value`,-`Approximate Value`) %&gt;% # Remove specific column variables
  left_join(wAV_schools,by=&quot;School&quot;) %&gt;% # Apply left_join
  filter(!School==&#39;None&#39;) %&gt;% # Remove observations that are empty in the School variable
  filter_at(vars(`Top Players`, `Total wAV`), all_vars(!is.na(.))) %&gt;% # Remove rows with NA values in specific columns
  arrange(desc(`Total wAV`)) %&gt;% # Arrange by specific variable
  mutate(School = str_replace(School, &quot;St\\.$&quot;, &quot;State&quot;), # Replace specific string with a different string
         School = str_replace(School, &quot;Col\\.&quot;, &quot;College&quot;),
         School = str_replace(School, &quot;East\\.&quot;, &quot;Eastern&quot;)) %&gt;%
  left_join(ncaa_schools_adj, by = &quot;School&quot;) %&gt;% # Apply left_join
  relocate(Conference, .after=School) # Move conference variable to display following school variable</code></pre>
<p>To provide a first look at how each conference compares to one another, we can look at the number of schools in each conference that produce NFL stars. This indicates a conference’s strength and depth in competitiveness, as a strong conference would have many different schools producing high-level talent.</p>
<pre class="r"><code># Count number of schools represented in the top 255 players for each conference
college_totals %&gt;%
  group_by(Conference) %&gt;% # Create subsets by conference
  summarize(n=n()) %&gt;% # Count number of schools represented in each conference
  mutate(prop_n=n/sum(n),
         prop_n=round(prop_n,3)) %&gt;% # # Create new varaiable to display proportion of schools
  arrange(desc(n)) # Arrange in descending order</code></pre>
<pre><code>## # A tibble: 28 × 3
##    Conference            n prop_n
##    &lt;chr&gt;             &lt;int&gt;  &lt;dbl&gt;
##  1 ACC                  13  0.121
##  2 Big Ten              12  0.112
##  3 SEC                  12  0.112
##  4 Pac-12               10  0.093
##  5 Big 12                9  0.084
##  6 SWAC                  9  0.084
##  7 Mountain West         5  0.047
##  8 American Athletic     4  0.037
##  9 Mid-American          4  0.037
## 10 Conference USA        3  0.028
## # … with 18 more rows</code></pre>
<p>Schools in the ACC are represented the most within the top 255 players. There also appears to be a slight gap in this category, with the top six conferences (ACC, Big Ten, SEC, Pac-12, Big 12, SWAC) having more schools that produce top-level NFL players.</p>
<p>Another metric to determine success is the number of selections for the Pro Bowl, with well-performing players generally selected for the Pro Bowl after every season.</p>
<pre class="r"><code>college_totals %&gt;%
  group_by(Conference) %&gt;%
  summarize(`Pro Bowl Selections` = sum(`Pro Bowl Selections`)) %&gt;%
  arrange(desc(`Pro Bowl Selections`))</code></pre>
<pre><code>## # A tibble: 28 × 2
##    Conference        `Pro Bowl Selections`
##    &lt;chr&gt;                             &lt;dbl&gt;
##  1 Big Ten                            1142
##  2 SEC                                1056
##  3 ACC                                 963
##  4 Pac-12                              914
##  5 Big 12                              523
##  6 SWAC                                280
##  7 FBS Independents                    219
##  8 American Athletic                   133
##  9 Mountain West                       127
## 10 Conference USA                       75
## # … with 18 more rows</code></pre>
<p>This time, there is a significant gap between the four conferences at the top (Big Ten, SEC, ACC, Pac-12) and the rest of the NCAA. We can also see that the top conference in pro bowl selections (Big Ten) differs from the top conference in school representation (ACC).</p>
<pre class="r"><code># Find total number of Hall of Famers from each conference
college_totals %&gt;%
  group_by(Conference) %&gt;% # Create subsets by conference
  summarize(`Hall of Famers` = sum(`Hall of Famers`)) %&gt;% # Find totals for each conference based on variable
  arrange(desc(`Hall of Famers`)) # Arrange by variable in descending order </code></pre>
<pre><code>## # A tibble: 28 × 2
##    Conference        `Hall of Famers`
##    &lt;chr&gt;                        &lt;dbl&gt;
##  1 Big Ten                         58
##  2 ACC                             47
##  3 Pac-12                          45
##  4 SEC                             36
##  5 Big 12                          18
##  6 SWAC                            18
##  7 FBS Independents                15
##  8 American Athletic               11
##  9 Conference USA                   5
## 10 MEAC                             5
## # … with 18 more rows</code></pre>
<pre class="r"><code>#Find total wAV value for each conference
college_totals %&gt;%
  group_by(Conference) %&gt;% # Create subsets by conference
  summarize(`Total wAV` = sum(`Total wAV`)) %&gt;% # Calculate sum of total wAV for each conference
  arrange(desc(`Total wAV`)) # Arrange by variable in descending order</code></pre>
<pre><code>## # A tibble: 28 × 2
##    Conference        `Total wAV`
##    &lt;chr&gt;                   &lt;dbl&gt;
##  1 ACC                      5444
##  2 Big Ten                  4125
##  3 SEC                      4120
##  4 Pac-12                   3973
##  5 SWAC                     1800
##  6 Big 12                   1490
##  7 Mountain West             883
##  8 Mid-American              743
##  9 FBS Independents          710
## 10 American Athletic         496
## # … with 18 more rows</code></pre>
<p>According to the total wAV for each conference, the ACC has produced the most successful NFL players. Like the distribution of Pro Bowl selections, there is a significant gap in total wAV value after the top four conferences.</p>
<p>To observe each conference’s yearly wAV progression, the 255 player datasets must first be joined together. Each player dataset was cleaned to display seasonal AV values, with the observation for the 2022 season removed since the season was ongoing. Additionally, a weight function was created to apply to each player’s AV values and match the wAV value for each player (100% of the best season, 95% of the second-best season, 90% of the third-best season, etc.). Each dataset was appended to the previous rendition, then saved as a new rendition.</p>
<pre class="r"><code># Create function to calculate wAV values for each season
weight &lt;- function(x){
  (1+0.05*(1-x))
}
# Create new object in environment
tom_brady_av &lt;- tom_brady %&gt;%
  select(Year,AV) %&gt;% # Remove all column except year and AV
  filter(!(Year %in% c(&#39;Career&#39;,&#39;20 yrs&#39;,&#39;3 yrs&#39;,&#39;2022&#39;))) # Remove specific rows
w &lt;- c() # Store empty vector
for(i in seq_along(tom_brady_av$AV)){ # Run for-loop to create weight vector for each year
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- tom_brady_av %&gt;% # Save object in environment
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;), # Replace specific string in variable
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;% # Arrange in descending order of AV
  mutate(w = w, # Create new variable for weight
         wAV = AV*w) %&gt;% # Create new variable for wAV
  arrange(Year) %&gt;% # Arrange by year
  select(-AV,-w) %&gt;% # Remove specific variables
  pivot_wider(names_from = Year, # differentiate by year
                values_from = wAV) %&gt;% # keep values of wAV in corresponding variable
  mutate(Player = &quot;Tom Brady&quot;) %&gt;% # Create new variable
  relocate(Player) # Move player variable to front of dataset
peyton_manning_av &lt;- peyton_manning %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;13 yrs&#39;,&#39;4 yrs&#39;)))
w &lt;- c()
for(i in seq_along(peyton_manning_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- peyton_manning_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Peyton Manning&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV) # Append to specific dataset
drew_brees_av &lt;- drew_brees %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;15 yrs&#39;,&#39;5 yrs&#39;)))
w &lt;- c()
for(i in seq_along(drew_brees_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- drew_brees_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Drew Brees&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
reggie_white_av &lt;- reggie_white %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;8 yrs&#39;,&#39;6 yrs&#39;,&#39;1 yr&#39;)))
w &lt;- c()
for(i in seq_along(reggie_white_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- reggie_white_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Reggie White&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
jerry_rice_av &lt;- jerry_rice %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;16 yrs&#39;,&#39;4 yrs&#39;,&#39;1 yr&#39;)),
         !is.na(Year)) # Remove observations with NA values in year
w &lt;- c()
for(i in seq_along(jerry_rice_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- jerry_rice_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Jerry Rice&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
ray_lewis_av &lt;- ray_lewis %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(ray_lewis_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- ray_lewis_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Ray Lewis&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
aaron_rodgers_av &lt;- aaron_rodgers %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;2022&#39;)))
w &lt;- c()
for(i in seq_along(aaron_rodgers_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- aaron_rodgers_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Aaron Rodgers&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
brett_favre_av &lt;- brett_favre %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;16 yrs&#39;,&#39;2 yrs&#39;,&#39;1 yr&#39;,&#39;1 yr&#39;)))
w &lt;- c()
for(i in seq_along(brett_favre_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- brett_favre_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Brett Favre&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
bruce_smith_av &lt;- bruce_smith %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;15 yrs&#39;,&#39;4 yrs&#39;)))
w &lt;- c()
for(i in seq_along(bruce_smith_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- bruce_smith_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Bruce Smith&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
philip_rivers_av &lt;- philip_rivers %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;16 yrs&#39;,&#39;1 yr&#39;)))
w &lt;- c()
for(i in seq_along(philip_rivers_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- philip_rivers_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Philip Rivers&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
fran_tarkenton_av &lt;- fran_tarkenton %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;13 yrs&#39;,&#39;5 yrs&#39;)))
w &lt;- c()
for(i in seq_along(fran_tarkenton_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- fran_tarkenton_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Fran Tarkenton&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
lawrence_taylor_av &lt;- lawrence_taylor %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(lawrence_taylor_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- lawrence_taylor_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Lawrence Taylor&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
dan_marino_av &lt;- dan_marino %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(dan_marino_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- dan_marino_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Dan Marino&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
matt_ryan_av &lt;- matt_ryan %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;14 yrs&#39;,&#39;1 yr&#39;,&#39;2022&#39;)))
w &lt;- c()
for(i in seq_along(matt_ryan_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- matt_ryan_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Matt Ryan&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
alan_page_av &lt;- alan_page %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;12 yrs&#39;,&#39;4 yrs&#39;)),
         !is.na(Year))
w &lt;- c()
for(i in seq_along(alan_page_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- alan_page_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Alan Page&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
rod_woodson_av &lt;- rod_woodson %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;10 yrs&#39;,&#39;4 yrs&#39;,&#39;2 yrs&#39;,&#39;1 yr&#39;)))
w &lt;- c()
for(i in seq_along(rod_woodson_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- rod_woodson_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Rod Woodson&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
derrick_brooks_av &lt;- derrick_brooks %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(derrick_brooks_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- derrick_brooks_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Derrick Brooks&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
john_elway_av &lt;- john_elway %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(john_elway_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- john_elway_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;John Elway&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
bruce_matthews_av &lt;- bruce_matthews %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(bruce_matthews_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- bruce_matthews_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Bruce Matthews&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
anthony_munoz_av &lt;- anthony_munoz %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(anthony_munoz_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- anthony_munoz_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Anthony Munoz&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
junior_seau_av &lt;- junior_seau %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;13 yrs&#39;,&#39;4 yrs&#39;,&#39;3 yrs&#39;)))
w &lt;- c()
for(i in seq_along(junior_seau_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- junior_seau_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Junior Seau&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
marshall_faulk_av &lt;- marshall_faulk %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;7 yrs&#39;,&#39;5 yrs&#39;)))
w &lt;- c()
for(i in seq_along(marshall_faulk_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- marshall_faulk_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Marshall Faulk&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
steve_young_av &lt;- steve_young %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;13 yrs&#39;,&#39;2 yrs&#39;)))
w &lt;- c()
for(i in seq_along(steve_young_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- steve_young_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Steve Young&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
carl_eller_av &lt;- carl_eller %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;15 yrs&#39;,&#39;1 yr&#39;)))
w &lt;- c()
for(i in seq_along(carl_eller_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- carl_eller_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Carl Eller&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
ben_roethlisberger_av &lt;- ben_roethlisberger %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(ben_roethlisberger_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- ben_roethlisberger_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Ben Roethlisberger&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
julius_peppers_av &lt;- julius_peppers %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;10 yrs&#39;,&#39;4 yrs&#39;,&#39;3 yrs&#39;)))
w &lt;- c()
for(i in seq_along(julius_peppers_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- julius_peppers_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Julius Peppers&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
randall_mcdaniel_av &lt;- randall_mcdaniel %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;12 yrs&#39;,&#39;2 yrs&#39;)))
w &lt;- c()
for(i in seq_along(randall_mcdaniel_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- randall_mcdaniel_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Randall McDaniel&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
emmitt_smith_av &lt;- emmitt_smith %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;13 yrs&#39;,&#39;2 yrs&#39;)))
w &lt;- c()
for(i in seq_along(emmitt_smith_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- emmitt_smith_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Emmitt Smith&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
ladainian_tomlinson_av &lt;- ladainian_tomlinson %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;9 yrs&#39;,&#39;2 yrs&#39;)))
w &lt;- c()
for(i in seq_along(ladainian_tomlinson_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- ladainian_tomlinson_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;LaDainian Tomlinson&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
deion_sanders_av &lt;- deion_sanders %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;5 yrs&#39;,&#39;5 yrs&#39;,&#39;2 yrs&#39;,&#39;1 yr&#39;,&#39;1 yr&#39;)))
w &lt;- c()
for(i in seq_along(deion_sanders_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- deion_sanders_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Deion Sanders&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
walter_payton_av &lt;- walter_payton %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(walter_payton_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- walter_payton_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Walter Payton&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
russell_wilson_av &lt;- russell_wilson %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;10 yrs&#39;,&#39;1 yr&#39;,&#39;2022&#39;)))
w &lt;- c()
for(i in seq_along(russell_wilson_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- russell_wilson_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Russell Wilson&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
joe_montana_av &lt;- joe_montana %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;13 yrs&#39;,&#39;2 yrs&#39;)))
w &lt;- c()
for(i in seq_along(joe_montana_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- joe_montana_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Joe Montana&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
randy_moss_av &lt;- randy_moss %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;8 yrs&#39;,&#39;4 yrs&#39;,&#39;2 yrs&#39;,&#39;1 yr&#39;,&#39;1 yr&#39;)),
         !is.na(Year))
w &lt;- c()
for(i in seq_along(randy_moss_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- randy_moss_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Randy Moss&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
mike_singletary_av &lt;- mike_singletary %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(mike_singletary_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- mike_singletary_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Mike Singletary&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
dan_fouts_av &lt;- dan_fouts %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(dan_fouts_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- dan_fouts_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Dan Fouts&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
marvin_harrison_av &lt;- marvin_harrison %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(marvin_harrison_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- marvin_harrison_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Marvin Harrison&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
ronnie_lott_av &lt;- ronnie_lott %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;10 yrs&#39;,&#39;2 yrs&#39;,&#39;2 yrs&#39;)))
w &lt;- c()
for(i in seq_along(ronnie_lott_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- ronnie_lott_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Ronnie Lott&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
michael_strahan_av &lt;- michael_strahan %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(michael_strahan_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- michael_strahan_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Michael Strahan&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
terrell_owens_av &lt;- terrell_owens %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;8 yrs&#39;,&#39;3 yrs&#39;,&#39;2 yrs&#39;,&#39;1 yr&#39;,&#39;1 yr&#39;)))
w &lt;- c()
for(i in seq_along(terrell_owens_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- terrell_owens_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Terrell Owens&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
eli_manning_av &lt;- eli_manning %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(eli_manning_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- eli_manning_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Eli Manning&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
ken_anderson_av &lt;- ken_anderson %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(ken_anderson_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- ken_anderson_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Ken Anderson&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
barry_sanders_av &lt;- barry_sanders %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(barry_sanders_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- barry_sanders_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Barry Sanders&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
brian_urlacher_av &lt;- brian_urlacher %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(brian_urlacher_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- brian_urlacher_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Brian Urlacher&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
paul_krause_av &lt;- paul_krause %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;12 yrs&#39;,&#39;4 yrs&#39;)))
w &lt;- c()
for(i in seq_along(paul_krause_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- paul_krause_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Paul Krause&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
jeff_saturday_av &lt;- jeff_saturday %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;13 yrs&#39;,&#39;1 yr&#39;)))
w &lt;- c()
for(i in seq_along(jeff_saturday_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- jeff_saturday_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Jeff Saturday&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
jason_taylor_av &lt;- jason_taylor %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;13 yrs&#39;,&#39;1 yr&#39;,&#39;1 yr&#39;)))
w &lt;- c()
for(i in seq_along(jason_taylor_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- jason_taylor_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Jason Taylor&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
champ_bailey_av &lt;- champ_bailey %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;10 yrs&#39;,&#39;5 yrs&#39;)))
w &lt;- c()
for(i in seq_along(champ_bailey_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- champ_bailey_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Champ Bailey&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
warren_sapp_av &lt;- warren_sapp %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;9 yrs&#39;,&#39;4 yrs&#39;)))
w &lt;- c()
for(i in seq_along(warren_sapp_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- warren_sapp_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Warren Sapp&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
merlin_olsen_av &lt;- merlin_olsen %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(merlin_olsen_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- merlin_olsen_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Merlin Olsen&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
warren_moon_av &lt;- warren_moon %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;10 yrs&#39;,&#39;3 yrs&#39;,&#39;2 yrs&#39;,&#39;2 yrs&#39;)))
w &lt;- c()
for(i in seq_along(warren_moon_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- warren_moon_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Warren Moon&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
randy_white_av &lt;- randy_white %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(randy_white_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- randy_white_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Randy White&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
reggie_wayne_av &lt;- reggie_wayne %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(reggie_wayne_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- reggie_wayne_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Reggie Wayne&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
charles_woodson_av &lt;- charles_woodson %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;11 yrs&#39;,&#39;7 yrs&#39;)))
w &lt;- c()
for(i in seq_along(charles_woodson_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- charles_woodson_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Charles Woodson&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
zach_thomas_av &lt;- zach_thomas %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;12 yrs&#39;,&#39;1 yr&#39;)))
w &lt;- c()
for(i in seq_along(zach_thomas_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- zach_thomas_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Zach Thomas&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
cam_newton_av &lt;- cam_newton %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;10 yrs&#39;,&#39;1 yr&#39;)))
w &lt;- c()
for(i in seq_along(cam_newton_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- cam_newton_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Cam Newton&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
mike_webster_av &lt;- mike_webster %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;15 yrs&#39;,&#39;2 yrs&#39;)))
w &lt;- c()
for(i in seq_along(mike_webster_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- mike_webster_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Mike Webster&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
chris_doleman_av &lt;- chris_doleman %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;10 yrs&#39;,&#39;3 yrs&#39;,&#39;2 yrs&#39;)))
w &lt;- c()
for(i in seq_along(chris_doleman_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- chris_doleman_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Chris Doleman&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
jahri_evans_av &lt;- jahri_evans %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;11 yrs&#39;,&#39;1 yr&#39;)))
w &lt;- c()
for(i in seq_along(jahri_evans_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- jahri_evans_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Jahri Evans&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
johnny_unitas_av &lt;- johnny_unitas %&gt;%
  select(Year,AV) %&gt;%
    mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;17 yrs&#39;,&#39;1 yr&#39;,&#39;1956&#39;,&#39;1957&#39;,&#39;1958&#39;,&#39;1959&#39;)))
w &lt;- c()
for(i in seq_along(johnny_unitas_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- johnny_unitas_av %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Johnny Unitas&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
jack_ham_av &lt;- jack_ham %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(jack_ham_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- jack_ham_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Jack Ham&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
will_shields_av &lt;- will_shields %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(will_shields_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- will_shields_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Will Shields&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
edgerrin_james_av &lt;- edgerrin_james %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;7 yrs&#39;,&#39;3 yrs&#39;,&#39;1 yr&#39;)))
w &lt;- c()
for(i in seq_along(edgerrin_james_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- edgerrin_james_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Edgerrin James&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
matthew_stafford_av &lt;- matthew_stafford %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;12 yrs&#39;,&#39;2 yrs&#39;,&#39;2022&#39;)))
w &lt;- c()
for(i in seq_along(matthew_stafford_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- matthew_stafford_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Matthew Stafford&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
ted_hendricks_av &lt;- ted_hendricks %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;9 yrs&#39;,&#39;5 yrs&#39;,&#39;1 yr&#39;)))
w &lt;- c()
for(i in seq_along(ted_hendricks_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- ted_hendricks_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Ted Hendricks&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
rickey_jackson_av &lt;- rickey_jackson %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;13 yrs&#39;,&#39;2 yrs&#39;)))
w &lt;- c()
for(i in seq_along(rickey_jackson_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- rickey_jackson_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Rickey Jackson&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
john_hannah_av &lt;- john_hannah %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(john_hannah_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- john_hannah_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;John Hannah&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
jim_otto_av &lt;- jim_otto %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(jim_otto_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- jim_otto_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Jim Otto&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
jack_youngblood_av &lt;- jack_youngblood %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(jack_youngblood_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- jack_youngblood_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Jack Youngblood&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
bob_lilly_av &lt;- bob_lilly %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(bob_lilly_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- bob_lilly_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Bob Lilly&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
willie_roaf_av &lt;- willie_roaf %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;9 yrs&#39;,&#39;4 yrs&#39;)))
w &lt;- c()
for(i in seq_along(willie_roaf_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- willie_roaf_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Willie Roaf&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
jack_lambert_av &lt;- jack_lambert %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(jack_lambert_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- jack_lambert_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Jack Lambert&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
aaron_donald_av &lt;- aaron_donald %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;2022&#39;)))
w &lt;- c()
for(i in seq_along(aaron_donald_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- aaron_donald_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Aaron Donald&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
thurman_thomas_av &lt;- thurman_thomas %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;12 yrs&#39;,&#39;1 yr&#39;)))
w &lt;- c()
for(i in seq_along(thurman_thomas_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- thurman_thomas_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Thurman Thomas&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
terrell_suggs_av &lt;- terrell_suggs %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;16 yrs&#39;,&#39;1 yr&#39;,&#39;1 yr&#39;)),
         !is.na(Year))
w &lt;- c()
for(i in seq_along(terrell_suggs_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- terrell_suggs_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Terrell Suggs&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
aeneas_williams_av &lt;- aeneas_williams %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;10 yrs&#39;,&#39;4 yrs&#39;)))
w &lt;- c()
for(i in seq_along(aeneas_williams_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- aeneas_williams_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Aeneas Williams&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
bobby_wagner_av &lt;- bobby_wagner %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;10 yrs&#39;,&#39;1 yr&#39;,&#39;2022&#39;)))
w &lt;- c()
for(i in seq_along(bobby_wagner_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- bobby_wagner_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Bobby Wagner&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
randall_cunningham_av &lt;- randall_cunningham %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;11 yrs&#39;,&#39;3 yrs&#39;,&#39;1 yr&#39;,&#39;1 yr&#39;)))
w &lt;- c()
for(i in seq_along(randall_cunningham_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- randall_cunningham_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Randall Cunningham&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
joe_greene_av &lt;- joe_greene %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(joe_greene_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- joe_greene_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Joe Greene&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
len_dawson_av &lt;- len_dawson %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;14 yrs&#39;,&#39;3 yrs&#39;,&#39;2 yrs&#39;,&#39;1957&#39;,&#39;1958&#39;,&#39;1959&#39;)))
w &lt;- c()
for(i in seq_along(len_dawson_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- len_dawson_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Len Dawson&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
willie_brown_av &lt;- willie_brown %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;12 yrs&#39;,&#39;4 yrs&#39;)))
w &lt;- c()
for(i in seq_along(willie_brown_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- willie_brown_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Willie Brown&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
ronde_barber_av &lt;- ronde_barber %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(ronde_barber_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- ronde_barber_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Ronde Barber&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
mike_haynes_av &lt;- mike_haynes %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;7 yrs&#39;,&#39;7 yrs&#39;)))
w &lt;- c()
for(i in seq_along(mike_haynes_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- mike_haynes_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Mike Haynes&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
paul_warfield_av &lt;- paul_warfield %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;8 yrs&#39;,&#39;5 yrs&#39;)))
w &lt;- c()
for(i in seq_along(paul_warfield_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- paul_warfield_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Paul Warfield&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
kevin_mawae_av &lt;- kevin_mawae %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;8 yrs&#39;,&#39;4 yrs&#39;,&#39;4 yrs&#39;)))
w &lt;- c()
for(i in seq_along(kevin_mawae_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- kevin_mawae_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Kevin Mawae&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
gene_upshaw_av &lt;- gene_upshaw %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(gene_upshaw_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- gene_upshaw_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Gene Upshaw&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
jim_brown_av &lt;- jim_brown %&gt;%
  select(Year,AV) %&gt;%
    mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;1957&#39;,&#39;1958&#39;,&#39;1959&#39;)))
w &lt;- c()
for(i in seq_along(jim_brown_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- jim_brown_av %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Jim Brown&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
john_randle_av &lt;- john_randle %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;11 yrs&#39;,&#39;3 yrs&#39;)))
w &lt;- c()
for(i in seq_along(john_randle_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- john_randle_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;John Randle&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
alan_faneca_av &lt;- alan_faneca %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;10 yrs&#39;,&#39;2 yrs&#39;,&#39;1 yr&#39;)))
w &lt;- c()
for(i in seq_along(alan_faneca_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- alan_faneca_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Alan Faneca&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
terry_bradshaw_av &lt;- terry_bradshaw %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(terry_bradshaw_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- terry_bradshaw_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Terry Bradshaw&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
jim_tyrer_av &lt;- jim_tyrer %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;13 yrs&#39;,&#39;1 yr&#39;)))
w &lt;- c()
for(i in seq_along(jim_tyrer_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- jim_tyrer_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Jim Tyrer&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
jj_watt_av &lt;- jj_watt %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;10 yrs&#39;,&#39;2 yrs&#39;,&#39;2022&#39;)))
w &lt;- c()
for(i in seq_along(jj_watt_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- jj_watt_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;J.J. Watt&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
tony_dorsett_av &lt;- tony_dorsett %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;11 yrs&#39;,&#39;1 yr&#39;)))
w &lt;- c()
for(i in seq_along(tony_dorsett_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- tony_dorsett_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Tony Dorsett&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
donovan_mcnabb_av &lt;- donovan_mcnabb %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;11 yrs&#39;,&#39;1 yr&#39;,&#39;1 yr&#39;)))
w &lt;- c()
for(i in seq_along(donovan_mcnabb_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- donovan_mcnabb_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Donovan McNabb&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
carson_palmer_av &lt;- carson_palmer %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;7 yrs&#39;,&#39;5 yrs&#39;,&#39;2 yrs&#39;)))
w &lt;- c()
for(i in seq_along(carson_palmer_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- carson_palmer_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Carson Palmer&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
boomer_esiason_av &lt;- boomer_esiason %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;10 yrs&#39;,&#39;3 yrs&#39;,&#39;1 yr&#39;)))
w &lt;- c()
for(i in seq_along(boomer_esiason_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- boomer_esiason_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Boomer Esiason&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
john_hadl_av &lt;- john_hadl %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;11 yrs&#39;,&#39;2 yrs&#39;,&#39;2 yrs&#39;,&#39;2 yrs&#39;)),
         !is.na(Year))
w &lt;- c()
for(i in seq_along(john_hadl_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- john_hadl_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;John Hadl&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
herb_adderley_av &lt;- herb_adderley %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;9 yrs&#39;,&#39;3 yrs&#39;)))
w &lt;- c()
for(i in seq_along(herb_adderley_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- herb_adderley_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Herb Adderley&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
tim_brown_av &lt;- tim_brown %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;16 yrs&#39;,&#39;1 yr&#39;)))
w &lt;- c()
for(i in seq_along(tim_brown_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- tim_brown_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Tim Brown&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
sonny_jurgensen_av &lt;- sonny_jurgensen %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;11 yrs&#39;,&#39;7 yrs&#39;,&#39;1957&#39;,&#39;1958&#39;,&#39;1959&#39;)))
w &lt;- c()
for(i in seq_along(sonny_jurgensen_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- sonny_jurgensen_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Sonny Jurgensen&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
drew_bledsoe_av &lt;- drew_bledsoe %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;9 yrs&#39;,&#39;3 yrs&#39;,&#39;2 yrs&#39;)))
w &lt;- c()
for(i in seq_along(drew_bledsoe_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- drew_bledsoe_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Drew Bledsoe&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
bobby_bell_av &lt;- bobby_bell %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(bobby_bell_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- bobby_bell_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Bobby Bell&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
nick_buoniconti_av &lt;- nick_buoniconti %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;7 yrs&#39;,&#39;7 yrs&#39;)))
w &lt;- c()
for(i in seq_along(nick_buoniconti_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- nick_buoniconti_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Nick Buoniconti&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
larry_little_av &lt;- larry_little %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;12 yrs&#39;,&#39;2 yrs&#39;)))
w &lt;- c()
for(i in seq_along(larry_little_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- larry_little_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Larry Little&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
michael_irvin_av &lt;- michael_irvin %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(michael_irvin_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- michael_irvin_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Michael Irvin&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
derrick_thomas_av &lt;- derrick_thomas %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(derrick_thomas_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- derrick_thomas_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Derrick Thomas&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
roger_staubach_av &lt;- roger_staubach %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(roger_staubach_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- roger_staubach_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Roger Staubach&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
ron_yary_av &lt;- ron_yary %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;14 yrs&#39;,&#39;1 yr&#39;)))
w &lt;- c()
for(i in seq_along(ron_yary_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- ron_yary_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Ron Yary&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
brian_dawkins_av &lt;- brian_dawkins %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;13 yrs&#39;,&#39;3 yrs&#39;)))
w &lt;- c()
for(i in seq_along(brian_dawkins_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- brian_dawkins_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Brian Dawkins&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
rod_smith_av &lt;- rod_smith %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(rod_smith_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- rod_smith_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Rod Smith&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
marcus_allen_av &lt;- marcus_allen %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;11 yrs&#39;,&#39;5 yrs&#39;)))
w &lt;- c()
for(i in seq_along(marcus_allen_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- marcus_allen_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Marcus Allen&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
bob_griese_av &lt;- bob_griese %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(bob_griese_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- bob_griese_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Bob Griese&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
orlando_pace_av &lt;- orlando_pace %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;12 yrs&#39;,&#39;1 yr&#39;)))
w &lt;- c()
for(i in seq_along(orlando_pace_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- orlando_pace_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Orlando Pace&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
franco_harris_av &lt;- franco_harris %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;12 yrs&#39;,&#39;1 yr&#39;)))
w &lt;- c()
for(i in seq_along(franco_harris_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- franco_harris_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Franco Harris&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
jimmy_johnson_av &lt;- jimmy_johnson %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(jimmy_johnson_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- jimmy_johnson_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Jimmy Johnson&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
deacon_jones_av &lt;- deacon_jones %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;11 yrs&#39;,&#39;2 yrs&#39;,&#39;1 yr&#39;)))
w &lt;- c()
for(i in seq_along(deacon_jones_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- deacon_jones_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Deacon Jones&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
gary_zimmerman_av &lt;- gary_zimmerman %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;7 yrs&#39;,&#39;5 yrs&#39;)))
w &lt;- c()
for(i in seq_along(gary_zimmerman_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- gary_zimmerman_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Gary Zimmerman&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
jim_kelly_av &lt;- jim_kelly %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(jim_kelly_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- jim_kelly_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Jim Kelly&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
darrell_green_av &lt;- darrell_green %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(darrell_green_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- darrell_green_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Darrell Green&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
calais_campbell_av &lt;- calais_campbell %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;9 yrs&#39;,&#39;3 yrs&#39;,&#39;3 yrs&#39;,&#39;2022&#39;)))
w &lt;- c()
for(i in seq_along(calais_campbell_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- calais_campbell_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Calais Campbell&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
steve_largent_av &lt;- steve_largent %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(steve_largent_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- steve_largent_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Steve Largent&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
mick_tingelhoff_av &lt;- mick_tingelhoff %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(mick_tingelhoff_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- mick_tingelhoff_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Mick Tingelhoff&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
willie_davis_av &lt;- willie_davis %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;10 yrs&#39;,&#39;2 yrs&#39;,&#39;1958&#39;,&#39;1959&#39;)))
w &lt;- c()
for(i in seq_along(willie_davis_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- willie_davis_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Willie Davis&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
isiah_robertson_av &lt;- isiah_robertson %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;8 yrs&#39;,&#39;4 yrs&#39;)))
w &lt;- c()
for(i in seq_along(isiah_robertson_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- isiah_robertson_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Isiah Robertson&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
tiki_barber_av &lt;- tiki_barber %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(tiki_barber_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- tiki_barber_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Tiki Barber&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
steve_smith_sr_av &lt;- steve_smith_sr %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;13 yrs&#39;,&#39;3 yrs&#39;)))
w &lt;- c()
for(i in seq_along(steve_smith_sr_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- steve_smith_sr_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Steve Smith Sr.&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
james_lofton_av &lt;- james_lofton %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;9 yrs&#39;,&#39;4 yrs&#39;,&#39;2 yrs&#39;,&#39;1 yr&#39;,&#39;1 yr&#39;)),
         !is.na(Year))
w &lt;- c()
for(i in seq_along(james_lofton_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- james_lofton_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;James Lofton&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
curtis_martin_av &lt;- curtis_martin %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;8 yrs&#39;,&#39;3 yrs&#39;)))
w &lt;- c()
for(i in seq_along(curtis_martin_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- curtis_martin_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Curtis Martin&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
logan_mankins_av &lt;- logan_mankins %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;9 yrs&#39;,&#39;2 yrs&#39;)))
w &lt;- c()
for(i in seq_along(logan_mankins_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- logan_mankins_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Logan Mankins&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
jim_marshall_av &lt;- jim_marshall %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;19 yrs&#39;,&#39;1 yr&#39;)))
w &lt;- c()
for(i in seq_along(jim_marshall_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- jim_marshall_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Jim Marshall&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
dan_hampton_av &lt;- dan_hampton %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(dan_hampton_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- dan_hampton_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Dan Hampton&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
steve_wisniewski_av &lt;- steve_wisniewski %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(steve_wisniewski_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- steve_wisniewski_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Steve Wisniewski&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
tom_nalen_av &lt;- tom_nalen %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(tom_nalen_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- tom_nalen_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Tom Nalen&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
ed_reed_av &lt;- ed_reed %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;11 yrs&#39;,&#39;1 yr&#39;,&#39;1 yr&#39;)),
         !is.na(Year))
w &lt;- c()
for(i in seq_along(ed_reed_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- ed_reed_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Ed Reed&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
kevin_williams_av &lt;- kevin_williams %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;11 yrs&#39;,&#39;1 yr&#39;,&#39;1 yr&#39;)))
w &lt;- c()
for(i in seq_along(kevin_williams_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- kevin_williams_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Kevin Williams&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
richmond_webb_av &lt;- richmond_webb %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;11 yrs&#39;,&#39;2 yrs&#39;)))
w &lt;- c()
for(i in seq_along(richmond_webb_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- richmond_webb_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Richmond Webb&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
sam_mills_av &lt;- sam_mills %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;9 yrs&#39;,&#39;3 yrs&#39;)))
w &lt;- c()
for(i in seq_along(sam_mills_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- sam_mills_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Sam Mills&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
larry_allen_av &lt;- larry_allen %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;12 yrs&#39;,&#39;2 yrs&#39;)))
w &lt;- c()
for(i in seq_along(larry_allen_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- larry_allen_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Larry Allen&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
don_maynard_av &lt;- don_maynard %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;13 yrs&#39;,&#39;1 yr&#39;,&#39;1 yr&#39;,&#39;1958&#39;,&#39;1959&#39;)))
w &lt;- c()
for(i in seq_along(don_maynard_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- don_maynard_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Don Maynard&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
justin_smith_av &lt;- justin_smith %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;7 yrs&#39;,&#39;7 yrs&#39;)))
w &lt;- c()
for(i in seq_along(justin_smith_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- justin_smith_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Justin Smith&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
adrian_peterson_av &lt;- adrian_peterson %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;10 yrs&#39;,&#39;2 yrs&#39;,&#39;1 yr&#39;,&#39;1 yr&#39;,&#39;1 yr&#39;,&#39;1 yr&#39;,&#39;1 yr&#39;)),
         !is.na(Year))
w &lt;- c()
for(i in seq_along(adrian_peterson_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- adrian_peterson_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Adrian Peterson&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
isaac_bruce_av &lt;- isaac_bruce %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;14 yrs&#39;,&#39;2 yrs&#39;)))
w &lt;- c()
for(i in seq_along(isaac_bruce_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- isaac_bruce_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Isaac Bruce&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
jared_allen_av &lt;- jared_allen %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;6 yrs&#39;,&#39;4 yrs&#39;,&#39;2 yrs&#39;,&#39;1 yr&#39;)),
         !is.na(Year))
w &lt;- c()
for(i in seq_along(jared_allen_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- jared_allen_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Jared Allen&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
demarcus_ware_av &lt;- demarcus_ware %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;9 yrs&#39;,&#39;3 yrs&#39;)))
w &lt;- c()
for(i in seq_along(demarcus_ware_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- demarcus_ware_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;DeMarcus Ware&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
steve_mcmichael_av &lt;- steve_mcmichael %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;13 yrs&#39;,&#39;1 yr&#39;,&#39;1 yr&#39;)))
w &lt;- c()
for(i in seq_along(steve_mcmichael_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- steve_mcmichael_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Steve McMichael&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
von_miller_av &lt;- von_miller %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;10 yrs&#39;,&#39;1 yr&#39;,&#39;1 yr&#39;,&#39;2022&#39;)),
         !is.na(Year))
w &lt;- c()
for(i in seq_along(von_miller_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- von_miller_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Von Miller&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
lem_barney_av &lt;- lem_barney %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(lem_barney_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- lem_barney_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Lem Barney&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
haloti_ngata_av &lt;- haloti_ngata %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;9 yrs&#39;,&#39;3 yrs&#39;,&#39;1 yr&#39;)))
w &lt;- c()
for(i in seq_along(haloti_ngata_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- haloti_ngata_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Haloti Ngata&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
andrew_whitworth_av &lt;- andrew_whitworth %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;11 yrs&#39;,&#39;5 yrs&#39;)))
w &lt;- c()
for(i in seq_along(andrew_whitworth_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- andrew_whitworth_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Andrew Whitworth&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
ndamukong_suh_av &lt;- ndamukong_suh %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;5 yrs&#39;,&#39;3 yrs&#39;,&#39;3 yrs&#39;,&#39;1 yr&#39;)))
w &lt;- c()
for(i in seq_along(ndamukong_suh_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- ndamukong_suh_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Ndamukong Suh&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
chris_hanburger_av &lt;- chris_hanburger %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(chris_hanburger_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- chris_hanburger_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Chris Hanburger&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
ricky_watters_av &lt;- ricky_watters %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;4 yrs&#39;,&#39;3 yrs&#39;,&#39;3 yrs&#39;)))
w &lt;- c()
for(i in seq_along(ricky_watters_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- ricky_watters_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Ricky Watters&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
mel_renfro_av &lt;- mel_renfro %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(mel_renfro_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- mel_renfro_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Mel Renfro&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
torry_holt_av &lt;- torry_holt %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;10 yrs&#39;,&#39;1 yr&#39;)))
w &lt;- c()
for(i in seq_along(torry_holt_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- torry_holt_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Torry Holt&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
julio_jones_av &lt;- julio_jones %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;10 yrs&#39;,&#39;1 yr&#39;,&#39;1 yr&#39;,&#39;2022&#39;)))
w &lt;- c()
for(i in seq_along(julio_jones_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- julio_jones_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Julio Jones&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
john_brodie_av &lt;- john_brodie %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;1957&#39;,&#39;1958&#39;,&#39;1959&#39;)))
w &lt;- c()
for(i in seq_along(john_brodie_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- john_brodie_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;John Brodie&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
wilber_marshall_av &lt;- wilber_marshall %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;5 yrs&#39;,&#39;4 yrs&#39;,&#39;1 yr&#39;,&#39;1 yr&#39;,&#39;1 yr&#39;)))
w &lt;- c()
for(i in seq_along(wilber_marshall_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- wilber_marshall_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Wilber Marshall&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
steve_mcnair_av &lt;- steve_mcnair %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;11 yrs&#39;,&#39;2 yrs&#39;)))
w &lt;- c()
for(i in seq_along(steve_mcnair_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- steve_mcnair_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Steve McNair&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
cris_carter_av &lt;- cris_carter %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;12 yrs&#39;,&#39;3 yrs&#39;,&#39;1 yr&#39;)))
w &lt;- c()
for(i in seq_along(cris_carter_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- cris_carter_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Cris Carter&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
lance_alworth_av &lt;- lance_alworth %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;9 yrs&#39;,&#39;2 yrs&#39;)))
w &lt;- c()
for(i in seq_along(lance_alworth_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- lance_alworth_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Lance Alworth&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
pat_swilling_av &lt;- pat_swilling %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;7 yrs&#39;,&#39;3 yrs&#39;,&#39;2 yrs&#39;)))
w &lt;- c()
for(i in seq_along(pat_swilling_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- pat_swilling_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Pat Swilling&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
oj_simpson_av &lt;- oj_simpson %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;9 yrs&#39;,&#39;2 yrs&#39;)))
w &lt;- c()
for(i in seq_along(oj_simpson_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- oj_simpson_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;O.J. Simpson&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
lance_briggs_av &lt;- lance_briggs %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(lance_briggs_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- lance_briggs_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Lance Briggs&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
lomas_brown_av &lt;- lomas_brown %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;11 yrs&#39;,&#39;3 yrs&#39;,&#39;2 yrs&#39;,&#39;1 yr&#39;,&#39;1 yr&#39;)))
w &lt;- c()
for(i in seq_along(lomas_brown_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- lomas_brown_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Lomas Brown&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
patrick_peterson_av &lt;- patrick_peterson %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;10 yrs&#39;,&#39;2 yrs&#39;,&#39;2022&#39;)))
w &lt;- c()
for(i in seq_along(patrick_peterson_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- patrick_peterson_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Patrick Peterson&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
alex_karras_av &lt;- alex_karras %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;1958&#39;,&#39;1959&#39;)))
w &lt;- c()
for(i in seq_along(alex_karras_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- alex_karras_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Alex Karras&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
richard_dent_av &lt;- richard_dent %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;12 yrs&#39;,&#39;1 yr&#39;,&#39;1 yr&#39;,&#39;1 yr&#39;)))
w &lt;- c()
for(i in seq_along(richard_dent_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- richard_dent_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Richard Dent&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
roman_gabriel_av &lt;- roman_gabriel %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;11 yrs&#39;,&#39;5 yrs&#39;)))
w &lt;- c()
for(i in seq_along(roman_gabriel_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- roman_gabriel_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Roman Gabriel&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
andre_reed_av &lt;- andre_reed %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;15 yrs&#39;,&#39;1 yr&#39;)))
w &lt;- c()
for(i in seq_along(andre_reed_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- andre_reed_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Andre Reed&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
alex_smith_av &lt;- alex_smith %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;7 yrs&#39;,&#39;5 yrs&#39;,&#39;2 yrs&#39;)))
w &lt;- c()
for(i in seq_along(alex_smith_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- alex_smith_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Alex Smith&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
walter_jones_av &lt;- walter_jones %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(walter_jones_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- walter_jones_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Walter Jones&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
cortez_kennedy_av &lt;- cortez_kennedy %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(cortez_kennedy_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- cortez_kennedy_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Cortez Kennedy&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
mel_blount_av &lt;- mel_blount %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(mel_blount_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- mel_blount_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Mel Blount&quot;) %&gt;%
  relocate(Player)%&gt;%
  bind_rows(player_yearly_wAV)
hardy_nickerson_av &lt;- hardy_nickerson %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;7 yrs&#39;,&#39;6 yrs&#39;,&#39;2 yrs&#39;,&#39;1 yr&#39;)))
w &lt;- c()
for(i in seq_along(hardy_nickerson_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- hardy_nickerson_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Hardy Nickerson&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
richard_sherman_av &lt;- richard_sherman %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;7 yrs&#39;,&#39;3 yrs&#39;,&#39;1 yr&#39;)))
w &lt;- c()
for(i in seq_along(richard_sherman_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- richard_sherman_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Richard Sherman&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
ron_mcdole_av &lt;- ron_mcdole %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;8 yrs&#39;,&#39;8 yrs&#39;,&#39;1 yr&#39;,&#39;1 yr&#39;)))
w &lt;- c()
for(i in seq_along(ron_mcdole_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- ron_mcdole_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Ron McDole&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
cornell_green_av &lt;- cornell_green %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(cornell_green_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- cornell_green_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Cornell Green&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
rich_gannon_av &lt;- rich_gannon %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;6 yrs&#39;,&#39;6 yrs&#39;,&#39;4 yrs&#39;,&#39;1 yr&#39;)))
w &lt;- c()
for(i in seq_along(rich_gannon_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- rich_gannon_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Rich Gannon&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
henry_ellard_av &lt;- henry_ellard %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;11 yrs&#39;,&#39;5 yrs&#39;,&#39;1 yr&#39;)),
         !is.na(Year))
w &lt;- c()
for(i in seq_along(henry_ellard_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- henry_ellard_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Henry Ellard&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
dave_krieg_av &lt;- dave_krieg %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;12 yrs&#39;,&#39;2 yrs&#39;,&#39;2 yrs&#39;,&#39;1 yr&#39;,&#39;1 yr&#39;,&#39;1 yr&#39;)))
w &lt;- c()
for(i in seq_along(dave_krieg_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- dave_krieg_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Dave Krieg&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
jason_peters_av &lt;- jason_peters %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;11 yrs&#39;,&#39;5 yrs&#39;,&#39;1 yr&#39;,&#39;1 yr&#39;,&#39;2022&#39;)))
w &lt;- c()
for(i in seq_along(jason_peters_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- jason_peters_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Jason Peters&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
vinny_testaverde_av &lt;- vinny_testaverde %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;7 yrs&#39;,&#39;6 yrs&#39;,&#39;3 yrs&#39;,&#39;2 yrs&#39;,&#39;1 yr&#39;,&#39;1 yr&#39;,&#39;1 yr&#39;)))
w &lt;- c()
for(i in seq_along(vinny_testaverde_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- vinny_testaverde_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Vinny Testaverde&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
george_blanda_av &lt;- george_blanda %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;10 yrs&#39;,&#39;9 yrs&#39;,&#39;7 yrs&#39;,&#39;1 yr&#39;,&#39;1949&#39;,&#39;1950&#39;,&#39;1951&#39;,&#39;1952&#39;,&#39;1953&#39;,&#39;1954&#39;,&#39;1955&#39;,&#39;1956&#39;,&#39;1957&#39;,&#39;1958&#39;,&#39;1959&#39;)),
         !is.na(Year))
w &lt;- c()
for(i in seq_along(george_blanda_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- george_blanda_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;George Blanda&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
mark_brunell_av &lt;- mark_brunell %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;9 yrs&#39;,&#39;3 yrs&#39;,&#39;2 yrs&#39;,&#39;2 yrs&#39;,&#39;1 yr&#39;)))
w &lt;- c()
for(i in seq_along(mark_brunell_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- mark_brunell_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Mark Brunell&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
warrick_dunn_av &lt;- warrick_dunn %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;6 yrs&#39;,&#39;6 yrs&#39;)))
w &lt;- c()
for(i in seq_along(warrick_dunn_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- warrick_dunn_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Warrick Dunn&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
ken_riley_av &lt;- ken_riley %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(ken_riley_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- ken_riley_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Ken Riley&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
neil_smith_av &lt;- neil_smith %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;9 yrs&#39;,&#39;3 yrs&#39;,&#39;1 yr&#39;)))
w &lt;- c()
for(i in seq_along(neil_smith_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- neil_smith_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Neil Smith&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
troy_polamalu_av &lt;- troy_polamalu %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(troy_polamalu_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- troy_polamalu_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Troy Polamalu&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
buck_buchanan_av &lt;- buck_buchanan %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(buck_buchanan_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- buck_buchanan_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Buck Buchanan&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
dermontti_dawson_av &lt;- dermontti_dawson %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(dermontti_dawson_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- dermontti_dawson_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Dermontti Dawson&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
eric_allen_av &lt;- eric_allen %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;7 yrs&#39;,&#39;4 yrs&#39;,&#39;3 yrs&#39;)))
w &lt;- c()
for(i in seq_along(eric_allen_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- eric_allen_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Eric Allen&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
mike_kenn_av &lt;- mike_kenn %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(mike_kenn_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- mike_kenn_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Mike Kenn&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
troy_aikman_av &lt;- troy_aikman %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(troy_aikman_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- troy_aikman_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Troy Aikman&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
kurt_warner_av &lt;- kurt_warner %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;6 yrs&#39;,&#39;5 yrs&#39;,&#39;1 yr&#39;)))
w &lt;- c()
for(i in seq_along(kurt_warner_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- kurt_warner_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Kurt Warner&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
forrest_gregg_av &lt;- forrest_gregg %&gt;%
  select(Year,AV) %&gt;%
    mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;14 yrs&#39;,&#39;1 yr&#39;,&#39;1956&#39;,&#39;1957&#39;,&#39;1958&#39;,&#39;1959&#39;)))
w &lt;- c()
for(i in seq_along(forrest_gregg_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- forrest_gregg_av %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Forrest Gregg&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
harry_carson_av &lt;- harry_carson %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(harry_carson_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- harry_carson_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Harry Carson&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
tony_gonzalez_av &lt;- tony_gonzalez %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;12 yrs&#39;,&#39;5 yrs&#39;)))
w &lt;- c()
for(i in seq_along(tony_gonzalez_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- tony_gonzalez_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Tony Gonzalez&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
jonathan_ogden_av &lt;- jonathan_ogden %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(jonathan_ogden_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- jonathan_ogden_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Jonathan Ogden&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
willie_wood_av &lt;- willie_wood %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(willie_wood_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- willie_wood_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Willie Wood&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
jim_hart_av &lt;- jim_hart %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;18 yrs&#39;,&#39;1 yr&#39;)))
w &lt;- c()
for(i in seq_along(jim_hart_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- jim_hart_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Jim Hart&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
ken_houston_av &lt;- ken_houston %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;8 yrs&#39;,&#39;6 yrs&#39;)))
w &lt;- c()
for(i in seq_along(ken_houston_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- ken_houston_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Ken Houston&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
roger_craig_av &lt;- roger_craig %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;8 yrs&#39;,&#39;2 yrs&#39;,&#39;1 yr&#39;)))
w &lt;- c()
for(i in seq_along(roger_craig_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- roger_craig_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Roger Craig&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
london_fletcher_av &lt;- london_fletcher %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;7 yrs&#39;,&#39;5 yrs&#39;,&#39;4 yrs&#39;)))
w &lt;- c()
for(i in seq_along(london_fletcher_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- london_fletcher_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;London Fletcher&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
ray_nitschke_av &lt;- ray_nitschke %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;1958&#39;,&#39;1959&#39;)))
w &lt;- c()
for(i in seq_along(ray_nitschke_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- ray_nitschke_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Ray Nitschke&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
howie_long_av &lt;- howie_long %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(howie_long_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- howie_long_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Howie Long&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
charley_taylor_av &lt;- charley_taylor %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(charley_taylor_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- charley_taylor_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Charley Taylor&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
james_farrior_av &lt;- james_farrior %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;10 yrs&#39;,&#39;5 yrs&#39;)))
w &lt;- c()
for(i in seq_along(james_farrior_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- james_farrior_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;James Farrior&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
lemar_parrish_av &lt;- lemar_parrish %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;8 yrs&#39;,&#39;4 yrs&#39;,&#39;1 yr&#39;)))
w &lt;- c()
for(i in seq_along(lemar_parrish_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- lemar_parrish_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Lemar Parrish&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
bobby_boyd_av &lt;- bobby_boyd %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(bobby_boyd_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- bobby_boyd_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Bobby Boyd&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
henry_jordan_av &lt;- henry_jordan %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;11 yrs&#39;,&#39;2 yrs&#39;,&#39;1957&#39;,&#39;1958&#39;,&#39;1959&#39;)))
w &lt;- c()
for(i in seq_along(henry_jordan_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- henry_jordan_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Henry Jordan&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
tony_romo_av &lt;- tony_romo %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(tony_romo_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- tony_romo_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Tony Romo&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
chuck_howley_av &lt;- chuck_howley %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;13 yrs&#39;,&#39;2 yrs&#39;,&#39;1958&#39;,&#39;1959&#39;)))
w &lt;- c()
for(i in seq_along(chuck_howley_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- chuck_howley_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Chuck Howley&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
steve_hutchinson_av &lt;- steve_hutchinson %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;6 yrs&#39;,&#39;5 yrs&#39;,&#39;1 yr&#39;)))
w &lt;- c()
for(i in seq_along(steve_hutchinson_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- steve_hutchinson_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Steve Hutchinson&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
andre_johnson_av &lt;- andre_johnson %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;12 yrs&#39;,&#39;1 yr&#39;,&#39;1 yr&#39;)))
w &lt;- c()
for(i in seq_along(andre_johnson_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- andre_johnson_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Andre Johnson&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
dick_schafrath_av &lt;- dick_schafrath %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;1959&#39;)))
w &lt;- c()
for(i in seq_along(dick_schafrath_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- dick_schafrath_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Dick Schafrath&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
frank_gore_av &lt;- frank_gore %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;10 yrs&#39;,&#39;3 yrs&#39;,&#39;1 yr&#39;,&#39;1 yr&#39;,&#39;1 yr&#39;)))
w &lt;- c()
for(i in seq_along(frank_gore_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- frank_gore_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Frank Gore&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
clay_matthews_av &lt;- clay_matthews %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;16 yrs&#39;,&#39;3 yrs&#39;)))
w &lt;- c()
for(i in seq_along(clay_matthews_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- clay_matthews_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Clay Matthews&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
too_tall_jones_av &lt;- too_tall_jones %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(too_tall_jones_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- too_tall_jones_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Too Tall Jones&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
johnny_robinson_av &lt;- johnny_robinson %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(johnny_robinson_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- johnny_robinson_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Johnny Robinson&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
trent_green_av &lt;- trent_green %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;6 yrs&#39;,&#39;2 yrs&#39;,&#39;2 yrs&#39;,&#39;1 yr&#39;)))
w &lt;- c()
for(i in seq_along(trent_green_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- trent_green_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Trent Green&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
jimmy_smith_av &lt;- jimmy_smith %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;11 yrs&#39;,&#39;1 yr&#39;)))
w &lt;- c()
for(i in seq_along(jimmy_smith_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- jimmy_smith_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Jimmy Smith&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
joe_namath_av &lt;- joe_namath %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;12 yrs&#39;,&#39;1 yr&#39;)))
w &lt;- c()
for(i in seq_along(joe_namath_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- joe_namath_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Joe Namath&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
darrelle_revis_av &lt;- darrelle_revis %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;8 yrs&#39;,&#39;1 yr&#39;,&#39;1 yr&#39;,&#39;1 yr&#39;)))
w &lt;- c()
for(i in seq_along(darrelle_revis_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- darrelle_revis_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Darrelle Revis&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
larry_fitzgerald_av &lt;- larry_fitzgerald %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(larry_fitzgerald_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- larry_fitzgerald_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Larry Fitzgerald&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
mike_munchak_av &lt;- mike_munchak %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(mike_munchak_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- mike_munchak_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Mike Munchak&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
karl_mecklenburg_av &lt;- karl_mecklenburg %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(karl_mecklenburg_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- karl_mecklenburg_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Karl Mecklenburg&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
antonio_gates_av &lt;- antonio_gates %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(antonio_gates_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- antonio_gates_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Antonio Gates&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
patrick_willis_av &lt;- patrick_willis %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(patrick_willis_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- patrick_willis_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Patrick Willis&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
willie_anderson_av &lt;- willie_anderson %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;12 yrs&#39;,&#39;1 yr&#39;)))
w &lt;- c()
for(i in seq_along(willie_anderson_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- willie_anderson_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Willie Anderson&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
harold_jackson_av &lt;- harold_jackson %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;6 yrs&#39;,&#39;4 yrs&#39;,&#39;4 yrs&#39;,&#39;1 yrs&#39;,&#39;1 yr&#39;)))
w &lt;- c()
for(i in seq_along(harold_jackson_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- harold_jackson_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Harold Jackson&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
art_shell_av &lt;- art_shell %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(art_shell_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- art_shell_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Art Shell&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
wayne_walker_av &lt;- wayne_walker %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;1958&#39;,&#39;1959&#39;)))
w &lt;- c()
for(i in seq_along(wayne_walker_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- wayne_walker_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Wayne Walker&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
ken_stabler_av &lt;- ken_stabler %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;10 yrs&#39;,&#39;3 yrs&#39;,&#39;2 yrs&#39;)))
w &lt;- c()
for(i in seq_along(ken_stabler_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- ken_stabler_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Ken Stabler&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
joe_flacco_av &lt;- joe_flacco %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;11 yrs&#39;,&#39;3 yrs&#39;,&#39;1 yr&#39;,&#39;2022&#39;)))
w &lt;- c()
for(i in seq_along(joe_flacco_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- joe_flacco_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Joe Flacco&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
kevin_greene_av &lt;- kevin_greene %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;8 yrs&#39;,&#39;3 yrs&#39;,&#39;3 yrs&#39;,&#39;1 yr&#39;)))
w &lt;- c()
for(i in seq_along(kevin_greene_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- kevin_greene_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Kevin Greene&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
cameron_jordan_av &lt;- cameron_jordan %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;2022&#39;)))
w &lt;- c()
for(i in seq_along(cameron_jordan_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- cameron_jordan_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Cameron Jordan&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
marshal_yanda_av &lt;- marshal_yanda %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(marshal_yanda_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- marshal_yanda_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Marshal Yanda&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
larry_grantham_av &lt;- larry_grantham %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(larry_grantham_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- larry_grantham_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Larry Grantham&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
michael_vick_av &lt;- michael_vick %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;6 yrs&#39;,&#39;5 yrs&#39;,&#39;1 yr&#39;,&#39;1 yr&#39;)))
w &lt;- c()
for(i in seq_along(michael_vick_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- michael_vick_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Michael Vick&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
antonio_brown_av &lt;- antonio_brown %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;9 yrs&#39;,&#39;2 yrs&#39;,&#39;1 yr&#39;)))
w &lt;- c()
for(i in seq_along(antonio_brown_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- antonio_brown_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Antonio Brown&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
eric_dickerson_av &lt;- eric_dickerson %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;5 yrs&#39;,&#39;5 yrs&#39;,&#39;1 yr&#39;,&#39;1 yr&#39;))) %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  filter(!(Year == &quot;&quot;))
w &lt;- c()
for(i in seq_along(eric_dickerson_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- eric_dickerson_av %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Eric Dickerson&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
charlie_joiner_av &lt;- charlie_joiner %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;11 yrs&#39;,&#39;4 yrs&#39;,&#39;4 yrs&#39;)),
         !is.na(Year))
w &lt;- c()
for(i in seq_along(charlie_joiner_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- charlie_joiner_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Charlie Joiner&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
bart_starr_av &lt;- bart_starr %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;1956&#39;,&#39;1957&#39;,&#39;1958&#39;,&#39;1959&#39;)))
w &lt;- c()
for(i in seq_along(bart_starr_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- bart_starr_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Bart Starr&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
larry_wilson_av &lt;- larry_wilson %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(larry_wilson_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- larry_wilson_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Larry Wilson&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
steve_grogan_av &lt;- steve_grogan %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(steve_grogan_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- steve_grogan_av %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Steve Grogan&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
tom_mack_av &lt;- tom_mack %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(tom_mack_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- tom_mack_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Tom Mack&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
john_abraham_av &lt;- john_abraham %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;7 yrs&#39;,&#39;6 yrs&#39;,&#39;2 yrs&#39;)))
w &lt;- c()
for(i in seq_along(john_abraham_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- john_abraham_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;John Abraham&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
phil_simms_av &lt;- phil_simms %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(phil_simms_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- phil_simms_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Phil Simms&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
luke_kuechly_av &lt;- luke_kuechly %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(luke_kuechly_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- luke_kuechly_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Luke Kuechly&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
james_harrison_av &lt;- james_harrison %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;14 yrs&#39;,&#39;1 yr&#39;,&#39;1 yr&#39;)),
         !is.na(Year))
w &lt;- c()
for(i in seq_along(james_harrison_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- james_harrison_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;James Harrison&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
donnie_shell_av &lt;- donnie_shell %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(donnie_shell_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- donnie_shell_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Donnie Shell&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
richard_seymour_av &lt;- richard_seymour %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;8 yrs&#39;,&#39;4 yrs&#39;)))
w &lt;- c()
for(i in seq_along(richard_seymour_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- richard_seymour_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Richard Seymour&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
cornelius_bennett_av &lt;- cornelius_bennett %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;9 yrs&#39;,&#39;3 yrs&#39;,&#39;2 yrs&#39;)))
w &lt;- c()
for(i in seq_along(cornelius_bennett_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- cornelius_bennett_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Cornelius Bennett&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
wes_welker_av &lt;- wes_welker %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;,&#39;6 yrs&#39;,&#39;3 yrs&#39;,&#39;2 yrs&#39;,&#39;1 yr&#39;,&#39;1 yr&#39;)),
         !is.na(Year))
w &lt;- c()
for(i in seq_along(wes_welker_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- wes_welker_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Wes Welker&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV)
roger_wehrli_av &lt;- roger_wehrli %&gt;%
  select(Year,AV) %&gt;%
  filter(!(Year %in% c(&#39;Career&#39;)))
w &lt;- c()
for(i in seq_along(roger_wehrli_av$AV)){
  w[i] &lt;- weight(i)
}
player_yearly_wAV &lt;- roger_wehrli_av %&gt;%
  mutate(Year = str_replace(Year,&quot;\\*&quot;,&quot;&quot;),
         Year = str_replace(Year, &quot;\\+&quot;,&quot;&quot;)) %&gt;%
  arrange(desc(AV)) %&gt;%
  mutate(w = w,
         wAV = AV*w) %&gt;%
  arrange(Year) %&gt;%
  select(-AV,-w) %&gt;%
  pivot_wider(names_from = Year,
                values_from = wAV) %&gt;%
  mutate(Player = &quot;Roger Wehrli&quot;) %&gt;%
  relocate(Player) %&gt;%
  bind_rows(player_yearly_wAV) %&gt;%
  select(sort(colnames(player_yearly_wAV))) %&gt;% # Arrange columns in chronological order
  relocate(Player) # Move player column to front of dataset</code></pre>
<p>After joining the wAV dataset to the new college dataset and removing other unwanted ID variables, the new yearly wAV dataset can be joined to the resultant dataset by the Player ID variable. Before joining, the leaders dataset had 255 observations with 2 unique IDs (Player, wAV), while the college dataset had 107 observations with 5 unique IDs (Conference, Hall of Famers, Pro Bowl Selections, Top Players, Total wAV). After removing unnecessary ID variables, the resulting dataset had 255 observations with 1 unique ID (Conference), while the yearly wAV dataset had 255 observations of 62 unique IDs (1960-2021), with the datasets sharing the Player ID variable. Since both dataset had the same number of observations, none were dropped during joining.</p>
<p>After joining, the new dataset was tidied to display a general year variable in place of individual year variables, and the yearly wAV value for each conference was calculated.</p>
<pre class="r"><code># Create new object in environment
wAV_years &lt;- wAV_leaders %&gt;%
  select(-Rank,-Tm,-Years) %&gt;% # Remove specific column variables
  mutate(School = str_replace(School, &quot;St\\.$&quot;, &quot;State&quot;), # Replace specific string with a different string 
         School = str_replace(School, &quot;Col\\.&quot;, &quot;College&quot;),
         School = str_replace(School, &quot;East\\.&quot;, &quot;Eastern&quot;)) %&gt;%
  left_join(college_totals,by = &quot;School&quot;) %&gt;% # Apply left_join
  relocate(Conference) %&gt;% # Move conference variable to front of dataset
  select(-School,-wAV,-`Hall of Famers`,-`Pro Bowl Selections`,-`Top Players`,-`Total wAV`) %&gt;% # Remove specific column variables
  left_join(player_yearly_wAV,by = &quot;Player&quot;) %&gt;% # Apply left_join
  select(-Player) %&gt;% # Remove player column variable
  group_by(Conference) %&gt;% # Create subsets by conference
  summarize_all(sum,na.rm=TRUE) %&gt;% # Add wAV values for each year
  pivot_longer(cols = c(`1960`:`2021`), # columns in table4a to put as rows
               names_to = &quot;Year&quot;, # save 1999 and 2000 as a variable year
               values_to = &quot;wAV&quot;) # save the cell values as a variable population</code></pre>
</div>
<div id="visualizing" class="section level2">
<h2>Visualizing</h2>
<pre class="r"><code># Join datasets together for ggplot visualization
wAV_leaders %&gt;%
  mutate(School = str_replace(School, &quot;St\\.$&quot;, &quot;State&quot;), # Replace specific string with a different string 
         School = str_replace(School, &quot;Col\\.&quot;, &quot;College&quot;),
         School = str_replace(School, &quot;East\\.&quot;, &quot;Eastern&quot;)) %&gt;%
  left_join(ncaa_schools_adj,by=&quot;School&quot;) %&gt;% # Apply left_join
  ggplot(aes(y=Conference,fill=Conference)) + # Create ggplot based on conference
  geom_bar() + # Create bar graph
  scale_x_continuous(expand=c(0,0), # Remove space between data and axes
                     limits=c(0,50)) + # Set x-axis to start at 0, end at 50
  labs(x=&quot;Number of Top Players&quot;,title=&quot;Distribution of Conferences&quot;) + # Create labels
  theme(legend.position=&quot;none&quot;) # Remove legend</code></pre>
<p><img src="/project/project1_files/figure-html/unnamed-chunk-10-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>This bar graph depicts the distribution of conferences among the 255 players in the wAV dataset. Through this graph, we can see that four conferences make up a significant portion of the players (ACC, SEC, Big Ten, Pac-12). All four of these conferences are part of the Power Five Conferences, so this distribution is expected.</p>
<pre class="r"><code># Create ggplot based on wAV
ggplot(wAV_leaders,aes(x=wAV,fill=..x..)) +
  geom_histogram(binwidth = 2, center = 1) + # Create a histogram
  scale_fill_gradient(low=&#39;blue&#39;, high=&#39;red&#39;) + # Set color gradient
  labs(y=&quot;Frequency&quot;,title=&quot;Distribution of Players&#39; wAV&quot;) + # Create labels
  theme(legend.position=&quot;none&quot;) # Remove legend</code></pre>
<p><img src="/project/project1_files/figure-html/unnamed-chunk-11-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>This histogram shows the distribution of wAV values for the 255 players in the wAV dataset. A right-skewed distribution is observed and expected, as only the best of the best players can maintain a high level of performance over many years of professional sports.</p>
<pre class="r"><code># Create ggplot based on Total wAV and Conference
ggplot(college_totals, aes(y=Conference,x=`Total wAV`,fill=Conference)) +
  geom_bar(stat=&quot;identity&quot;) +
  labs(title=&quot;Conference wAV Totals&quot;) + # Create title label
  theme(legend.position=&quot;none&quot;) +
    scale_x_continuous(expand=c(0,0), # Remove space between data and axes
                     limits=c(0,5500)) # Set x-axis to start at 0, end at 5500</code></pre>
<p><img src="/project/project1_files/figure-html/unnamed-chunk-12-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>This bar graph outlines the distribution of Total wAV for each conference. Four conferences appear to produce significantly more impactful players (ACC, SRC, Pac-12, Big Ten) than the remaining conferences, which is in line with what is to be expected.</p>
<pre class="r"><code># Create ggplot based on Hall of Famers and Conference
ggplot(college_totals, aes(y = Conference, x = `Hall of Famers`, fill = Conference)) +
  geom_bar(stat=&quot;identity&quot;) +
  labs(title = &quot;Hall of Famers by Conference&quot;) + # Create title label
  theme(legend.position=&quot;none&quot;) +
  scale_x_continuous(expand=c(0,0), # Remove space between data and axes
                     limits=c(0,60)) # Set x-axis to start at 0, end at 60</code></pre>
<p><img src="/project/project1_files/figure-html/unnamed-chunk-13-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>This bar graph depicts the distribution of players inducted into the Hall of Fame based on their college’s conference. Like what we previously saw, there are a few conferences that stand out with producing legendary players (Big Ten, ACC, Pac-12, SEC) , with a few others more behind (Big 12, SWAC, FBS Independents).</p>
<pre class="r"><code># Create ggplot based on Players aand Total wAV
ggplot(college_totals, aes(x = Players, y = `Total wAV`)) +
  geom_point(aes(color = Conference)) + # Color by conference
  labs(x = &quot;Players&quot;, y = &quot;Total wAV&quot;,title=&quot;Players vs. Total wAV&quot;) # Create labels for axes and title</code></pre>
<p><img src="/project/project1_files/figure-html/unnamed-chunk-14-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>This scatter plot involves the number of NFL players each conference has historically produced and the total wAV from the top 255 players. An interesting trend is that producing NFL-level talent does not necessarily equate to long-term success in the NFL, as the FBS Independents conference has sent the most players to the NFL but is behind a few conferences in terms of its total wAV value.</p>
<pre class="r"><code># Create function to return every 5th value
my_breaks &lt;- function(x, n = 5) {
  return(x[c(TRUE, rep(FALSE, n - 1))])
}
ggplot(data=wAV_years,aes(x=Year,y=wAV,color=Conference,group=Conference)) + # Create ggplot based on year, wAV, and conference
    geom_point() + # Show data as points
  geom_line() + # Connect conference points with lines
  scale_x_discrete(breaks = my_breaks) + # Set tick-marks
  theme(legend.title=element_text(size=8), # Adjust legend sizes
          legend.text=element_text(size=8),
          legend.position=&quot;bottom&quot;) +
  guides(colour=guide_legend(nrow=7)) + # Adjust number of rows in legend
  labs(title=&quot;wAV of Conferences over Time&quot;,y=&#39;Total wAV&#39;) # Create title label</code></pre>
<p><img src="/project/project1_files/figure-html/unnamed-chunk-15-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>This plot depicts the yearly wAV total for each conference from 1960-2021. With this, we can observe the success players from a certain conference have as a collective during a given season. Naturally, the conferences with the greatest total wAV values year-by-year generally are the Power Five conferences (ACC, Big Ten, Big 12, SEC Pac-12). However, an interesting trend is that no one conference has constantly dominated the NFL with their successful players; rather, there are peaks of success at different time periods.</p>
</div>
<div id="acknowledgements" class="section level2">
<h2>Acknowledgements</h2>
<p>Thank you to Phillip Kim for cleaning, tidying and joining datasets.</p>
<p>Thank you to Srikar Sriram for creating visualizations and summary statistics.</p>
</div>

            
        <hr>         <div class="related-posts">
                <h5>Related Posts</h5>
                
              </div> 
            </div>
          </div>

   <hr>  <div class="disqus">
  <div id="disqus_thread"></div>
  <script type="text/javascript">

    (function() {
      
      
      if (window.location.hostname == "localhost")
        return;

      var disqus_shortname = '';
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div> 
        </div>
      </div>
    </div>

    
    <footer>
  <div id="footer">
    <div class="container">
      <p class="text-muted">&copy; All rights reserved. Powered by <a href="https://gohugo.io/">Hugo</a> and
      <a href="http://www.github.com/nurlansu/hugo-sustain/">sustain</a> with ♥</p>
    </div>
  </div>
</footer>
<div class="footer"></div>


<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<script src="/js/docs.min.js"></script>
<script src="/js/main.js"></script>

<script src="/js/ie10-viewport-bug-workaround.js"></script>


    
  </body>
</html>
